---
title: "RWC23_ELT2_ChIP_Clusters_Gut_RNA"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

Pseudocode

- Make david's ChIP peak heatmaps with complex heatmap
- make row annotation based on Spencer LE and L2 

## Load Spencer et. al. intestine expression

This data is from a 2011 paper using FACS sorting of Late Embryo (LE) and Larval Stage 2 (L2) intestine cells, measured with microarray. See [Spencer et. al, (2011)](https://pubmed.ncbi.nlm.nih.gov/21177967/). Downloaded from companion website https://www.vanderbilt.edu/wormdoc/wormmap/Expressed_genes.html.    

```{r}
spencerLEgenes <-
  read.table(
    "./01_input/Spencer_et_al_2010_FACS_and_pulldown_tilling_array/LE-intestine_enr_vs_ref.WS200.txt",
    quote = "\"",
    comment.char = "",
    header = TRUE
  )
colnames(spencerLEgenes) <-
  str_c("spencer_LE_", colnames(spencerLEgenes))
spencer_LE_subset <-
  spencerLEgenes %>% select(spencer_LE_ID,
                            spencer_LE_AveExpr,
                            spencer_LE_adj_P_Val,
                            spencer_LE_FC)

spencer_LE_subset %>% head
```

```{r}
spencerL2genes <-
  read.table(
    "./01_input/Spencer_et_al_2010_FACS_and_pulldown_tilling_array/L2-intestine_enr_vs_ref.WS200.txt",
    quote = "\"",
    comment.char = "",
    header = TRUE
  )
colnames(spencerL2genes) <-
  str_c("spencer_L2_", colnames(spencerL2genes))
spencer_L2_subset <- spencerL2genes %>%
  select(spencer_L2_ID,
         spencer_L2_AveExpr,
         spencer_L2_adj_P_Val,
         spencer_L2_FC)

spencer_L2_subset %>% head
```

```{r}
elt2_peaks_spencer_LE <- elt2_peaks %>% right_join(spencer_LE_subset, by = c("WBGeneID" = "spencer_LE_ID"))
```

```{r}
ggplot(elt2_peaks_spencer_LE, aes(x = spencer_LE_AveExpr, y = spencer_LE_FC)) +
  geom_point() +
  facet_wrap(~ cluster.description)
```

```{r}
elt2_peaks_spencer_L2 <- elt2_peaks %>% right_join(spencer_L2_subset, by = c("WBGeneID" = "spencer_L2_ID"))
```

```{r}
ggplot(elt2_peaks_spencer_L2, aes(x = spencer_L2_AveExpr, y = spencer_L2_FC)) +
  geom_point() +
  facet_wrap(~ cluster.description)
```

Problem: Spencer only reported upregulated genes
